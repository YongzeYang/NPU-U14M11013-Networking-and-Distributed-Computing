# 文件传输系统 说明文档

## 1.描述

该系统通过套接字实现UDP文件传输系统。

其中，服务器端默认TCP端口为2021，UDP端口2023。客户端端口随机，由操作系统自动分配。

在该系统中，使用本地服务器localhost(127.0.0.1)。

## 2.文件结构

### FileClient.java

该类为客户端。客户端通过套接字建立服务器端的通信。

### FileServer.java

该类为服务器端，用于创建服务器端套接字。

### Handler.java

当客户端连接到服务器端后，服务器端会实例化该类，用于处理具体的业务逻辑。

## 3.使用方法

### 3.1 服务器端

在终端中输入以下命令启动服务器。

```
$java FileServer <root>
```

需设定启动参数，启动参数为共享目录在服务器端的系统根目录，为绝对路径。

启动后，服务器端会自动提示信息，包含客户端链接信息及客户端命令输入。

示例：启动服务器端，并有两个客户端连接到服务器，并向服务器端发送请求。 服务器信息提示如下所示：

```
$java FileServer D:\test
服务器已建立. IP地址:[127.0.0.1], 端口号:[20210].
根目录: [D:\test]. 
新客户端连接。 IP地址: [/127.0.0.1:3087]
新客户端连接。 IP地址: [/127.0.0.1:3093]
客户端[/127.0.0.1:3087]输入命令：ls
客户端[/127.0.0.1:3087]输入命令：cd
客户端[/127.0.0.1:3087]输入命令：cd  参数:<test>
注意：路径 <D:\test\test> 不存在或无效！
客户端[/127.0.0.1:3087]输入命令：cd  参数:<tesat1>
客户端[/127.0.0.1:3087]输入命令：cd..
客户端[/127.0.0.1:3087]输入命令：cd  参数:<..>
```


### 3.2 客户端

在终端中输入以下命令启动服务器。

```linux
$java FileClient
```

开启后，客户端会自动连接localhost本地服务器。若连接成功，则会有如下提示：

```linux
$java FileClient
已连接到服务器:[127.0.0.1:2021]。
该服务器用于实现文件的下载。用法：
ls              列出当前目录名单。
cd <dir>        跳转到<dir>
cd..            返回上一级目录。
get <filename>  下载文件<filename>
bye             关闭连接。
请输入命令:
```

用户可根据以上命令输入请求，也可输入bye退出。对于cd和get命令，需要输入一个参数，服务器端会自动判定参数是否有效。

用户每次输入后，都会得到服务器端发出的反馈，包括报错信息与当前路径提示。

例如，用户输入无效路径后，会得到如下反馈：

```linux
cd test
参数<test>无效！找不到文件或路径<D:\test\test>
当前路径：D:\test
```

注意：客户端无法指定服务器端的根目录，也无法进入根目录的上一级！

## 4.说明

本代码已于2021.9.17上传至[GitHub](https://github.com/YongzeYang/NPU-U14M11013-Networking-and-Distributed-Computing/tree/master/src/exec1).